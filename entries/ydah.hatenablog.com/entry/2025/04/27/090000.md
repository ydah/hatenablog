---
Title: 'オートマトンと言語理論 学習記 #2: 有限オートマトン'
Date: 2025-04-27T09:00:00+09:00
URL: https://ydah.hatenablog.com/entry/2025/04/27/090000
EditURL: https://blog.hatena.ne.jp/ydah/ydah.hatenablog.com/atom/entry/6802418398383917798
---

## はじめに

オートマトンと言語理論について表面的な理解にとどまっていたため、基礎から再度学習を始めることにしました。
この機会に、単に学習するだけでなく、学んだ内容を体系的にまとめていきたいと思います。

同じように学習している方や、これから学習しようと考えている方の参考になれば幸いです。参考文献を各回に記載していますので、興味がある方はそちらも参照してください。

## 参考文献

* 藤原暁宏. はじめて学ぶオートマトンと言語理論. 東京: 森北出版, 2015, 192p


[https://www.morikita.co.jp/books/mid/085291:embed:cite]


## 概要

はい。前回はオートマトンについて学びましたが、今回はオートマトンの中でもっとも単純な **有限オートマトン** について学びます。

## 言語とはなにか

言語は大きく分けて、2つに分けられます。「自然言語」と「人工言語」です。

自然言語とは、人間の社会の中で自然発生的に生まれ、歴史的に発展してきた言語のことを指します。英語や日本語、フランス語、中国語などがこれにあたります。
自然言語には以下の特徴があります:

* 自然発生的：特定の設計者がおらず、社会の中で自然に発生・進化してきた
* 曖昧性：多義性や文脈依存性が高い
* 不規則性：文法や語彙に例外が多い
* 複雑性：長い歴史を経て複雑な構造を持つ
* 文化的背景：その言語を使う文化や歴史と密接に関連している

一方で人工言語は特定の目的のために意図的に設計された言語です。大きく以下の種類に分けられます。

* 国際補助語：エスペラント語、イド語などの国際コミュニケーションを促進するために設計された言語
* プログラミング言語：Ruby、Python、Javaなどのコンピューターへの指示を与えるために設計された言語

人工言語には、特定の目的に応じて設計されているため、以下の特徴があります。

* 意図的設計：特定の目的や原則に基づいて設計されている
* 規則性：例外が少なく論理的な構造を持つ傾向がある
* 明確性：曖昧さを最小限に抑える設計が多い
* 使用範囲：特定のコミュニティや目的に限定されて使用されることが多い

このように、日常生活においてさまざまな言語を我々は使っていますが、これらの言語において共通する性質があります。それは一般的な言語は **記号** を用いて表されるということです[^1]。
たとえば、英語は主にアルファベットという記号を用いて表現されますし、日本語はひらがな、カタカナ、漢字などの文字を用いて表現されます。また、プログラミング言語も、アルファベットや数字という通常の記号に加えて、`+`や`*`などの算術記号や、`#`や`@`などの特殊記号を用いて表現されます。

[^1]: 実際には記号つまり文字を持たない言語も多数存在する。たとえば手話のような非音声言語も存在する。またアイヌ語も江戸時代以前は口承のみにより語り継がれていた。

ここから、言語というものは **記号を連続して並べたものの集合である** ということが言えます。

ただし、むやみやたらに記号を並べただけでは言語とは言えません。たとえば、`Ruby大好き`という文は "R" "u" "b" "y" "大" "好" "き" という記号の列で表現されています。
これは、普段日本語を使っている人からすると意味のある文章として認識できるでしょう。

しかし、 `大R好uyきb`だとどうでしょう。おそらく、この文を意味のある文章として認識する人はいないでしょう。つまり、使用可能な記号をただ並べただけでは言語とは言えません。このように有効な記号を単純に連続的に並べただけでは言語とはよべないことに留意が必要です。

記号集合に対する「言語」は以下のように定義できます。ただしこれは自然言語に対する言語学の分野での言語の定義とは異なっており、あくまで情報科学分野における言語の定義であることに留意ください。

```
記号集合Σの上の言語Lとは、スター閉包Σ*から特定の条件を満たす記号列を集めた部分集合であり、以下の式で示される。

L = { x | x ∈ Σ* かつ x は特定の条件を満たす }
```

たとえば、記号集合のΣがひらがな、カタカナ、漢字などの各文字で構成される集合である場合、日本語Lは、スター閉包Σ*の部分集合であり、特定の条件を満たす記号列の集合となります。日本語を定める条件に従うと、Σ* に含まれる記号列、`Ruby大好き` と `大R好uyきb` は以下の通りとなります。

```
"Ruby大好き" ∈ L, "大R好uyきb" ∉ L
```

ここで、上記の定義を考えると、「特定の条件」というものが何かが明らかにされていないことに気づく方もいらっしゃると思います。
この特定の条件がない限り、言語を定義することはできません。実は、この「特定の条件」を定めるものが、有限オートマトンに代表されるようなオートマトンや形式文法という訳です。

言い換えれば、 **オートマトンと形式文法は、どちらも言語を定めるための道具である** と言えます。

## 変換機械と認識機械

オートマトンは「入力」、「出力」、「状態」をもち、一連の入力に対して、その状態に応じた出力をする機械です。
この出力の方法によって、オートマトンは主に「変換機械」と「認識機械」の2つのタイプに分類できます。
これらの機械の例として「正しいローマ字」を処理する「認識機械」と「変換機械」を以下に示します。

<figure class="figure-image figure-image-fotolife" title="変換機械と認識機械の例">[f:id:ydah:20250427033414p:plain]<figcaption>変換機械と認識機械の例</figcaption></figure>

それでは以下にそれぞれの特徴と役割について説明します。

### 変換機械（Transducer）

変換機械は、入力文字列を別の文字列に変換する機械です。

特徴は次の通りです。

* 出力: 入力に対応する出力文字列を生成
* 目的: 入力を何らかのルールにしたがって変換する
* 状態遷移: 入力を読み込みながら状態を遷移させ、その過程で出力を生成

### 認識機械（Acceptor/Recognizer）

認識機械は、入力された文字列が特定の言語に属するかどうかを判定する機械です。

特徴は次の通りです。

* 出力: 基本的に「受理」または「拒否」の二値的な結果のみを出力
* 目的: 与えられた文字列が定義された言語に属するかを判定する
* 状態遷移: 入力を読み込みながら状態を遷移させ、最終的に受理状態に達するかどうかで判定

この認識機械としてのオートマトンを、前述の言語の「特定の条件」として用いることにより、以下のように言語 L を定義できます。

```
L = { x | x ∈ Σ* かつ x はオートマトンが受理する記号列 }
```

またこの時、言語L を **オートマトンが認識する言語** と呼びます。

## 有限オートマトンとは

では、ここからは有限オートマトンについて学んでいきましょう。
有限オートマトンとは、状態数が有限な認識機械としてのオートマトンであり、一連の入力列に対して、その入力に応じて状態を変化させ、入力集力時の状態に応じて「受理」、「拒否」のいずれかを出力するオートマトンです。

有限オートマトンは数学的なモデルなので、具体的なハードウェアは存在しませんが、以下に概念図を示します。

<figure class="figure-image figure-image-fotolife" title="有限オートマトン概念図">[f:id:ydah:20250427033519p:plain]<figcaption>有限オートマトン概念図</figcaption></figure>

この図に示すように、有限オートマトンは状態制御をする部分と、入力用のテープとテープからデータを読み出す場所を示す読み出しヘッドによって構成されます。
有限オートマトンの入力列は入力用テープ上に書き込まれていて、ヘッドの示す位置の記号を一文字ずつ状態制御をする部分が読み出すことで動作します。
また、読み出しヘッドが入力を読み出した後は、ヘッドを1つ右に移動して、次の入力を読み出す準備をします。

オートマトンの定義ですが、多くの部分は順序機械と同じです。まず、順序機械と同様に状態集合と、入力集合をそれぞれ集合Q、Σで表します。
ただし、順序機械と異なる部分は、出力を表す出力集合は存在しません。
また、状態集合 Q に含まれる1つの状態が、有限オートマトンの最初の状態を示す初期状態となります。

次に状態と入力に対する動作を表す状態遷移関数であるが、順序機械とは異なり有限オートマトンは状態と入力によって入力後の状態のみが定まるので以下のように定義されます。

```
有限オートマトンの状態遷移関数 δ は、状態 p ∈ Q と入力 a ∈ Σ に対して、次の状態 q ∈ Q を定める関数であり、次のように定義される。
  δ(p, a) = q
```

最後に、有限オートマトンの出力についてですが、入力終了時に「受理」または「拒否」のいずれかを出力します。この出力は、入力終了時の状態により定ります。
言い換えると、有限オートマトンでは、各状態は「入力が有限オートマトンの定める条件を満たしている状態」と「そうでない状態」に分けられています。

入力が有限オートマトンの定める条件を満たしている状態は **受理状態** と呼びます。そして受理状態の集合を F で表します。
また、受理状態は終了状態とも呼ばれます。受理状態の集合である F は、状態集合 Q の部分集合(F ⊆ Q) です。

なお、有限オートマトンは、状態と入力の組み合わせによる状態遷移が定義されていない場合もあります。
このような場合には、定義されていない入力が行われたときに、「拒否」を出力してそれ以降の入力を受け付けないものとします。

以上をまとめると、有限オートマトンの定義は以下のようになります。

```
有限オートマトン M は、三つの集合 Q, Σ, Fと、特別な状態 q0 ∈ Q、および関数δを指定することにより定まる計算のモデルであり、以下のように表される。

  M = (Q, Σ, δ, q0, F)

また、各要素は以下の通りである。

* Q: 状態の集合であり、有限オートマトンの状態を表す
* Σ: 入力記号の集合であり、有限オートマトンが受け付ける入力を表す
* F: 受理状態の集合であり、有限オートマトンが受理する状態を表す
* q0: 初期状態であり、有限オートマトンの計算を開始する状態
* δ: 状態遷移関数であり、状態と入力に基づいて次の状態を決定する
```

しかし、この定義だけでは有限オートマトンを理解するのは難しいため、例を交えて説明します。

### 10進数を受理する有限オートマトンの例

10進数を受理する有限オートマトンの例を考えてみましょう。
10進数は"0"から"9"までの数字を用いて表現される数値のことを指します。

まず、10進数は数字の"0"から"9"までの数字を用いて表現されることから、入力記号集合Σは以下のようになります。

```
Σ = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }
```

次に、数字のみで構成される記号列が10進数となる条件を考えます。

* 値が0の場合は、1つの"0"のみで構成される
* 値が0以外の場合には左端の記号は必ず"1"から"9"のいずれかであり、それ以外の記号は任意の個数の"0"から"9"までの数字で構成される

これらの条件から10進数として受理する/受理しない記号列を以下のように示すことができます。

* 受理する記号列
  * 0
  * 1
  * 9
  * 10
  * 1234567890
* 受理しない記号列
  * 01
  * 00000123456789
  * 0000

では、これらの条件を満たす有限オートマトンを定義してみましょう。

```
10進数を受理する有限オートマトン M は、以下のように定義されます。

M = (Q, Σ, δ, q0, F), Q = {q0, q1, q2}, Σ = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, F = {q1, q2}, δ(q0, 0) = q1,
δ(q0, 1) = q2, δ(q0, 2) = q2, δ(q0, 3) = q2, δ(q0, 4) = q2, δ(q0, 5) = q2, δ(q0, 6) = q2, δ(q0, 7) = q2,
δ(q0, 8) = q2, δ(q0, 9) = q2, δ(q2, 0) = q2, δ(q2, 1) = q2, δ(q2, 2) = q2, δ(q2, 3) = q2, δ(q2, 4) = q2,
δ(q2, 5) = q2, δ(q2, 6) = q2, δ(q2, 7) = q2, δ(q2, 8) = q2, δ(q2, 9) = q2
```

この有限オートマトンにおいて、状態 q0 は初期状態であり、最初に入力を読み込む状態です。
q1 と q2 はそれぞれ最初の入力が 0 と 1〜9 の場合に遷移する状態です。また、状態 q1 と q2 は、入力が有限オートマトンの定める条件を満たす状態であるため、受理状態となります。

### 状態遷移図と状態遷移表

有限オートマトンは記号だけを用いて数学的に定義ができますが、有限オートマトンの定義を見て、その動作を理解することはできたでしょうか。
そうなんです。実は、有限オートマトンの動作を人間が理解するためには、単に数学的定義だけだと非常に難しいです。

そこで、人間が理解しやすいように、図や表を用いて有限オートマトンの動作を示すことが一般的です。
ここからは、オートマトンを表す図である「状態遷移図」とオートマトンを表す表である「状態遷移表」について説明します。

#### 状態遷移図

では、先ほどの10進数を受理する有限オートマトンの状態遷移図を示します。

<figure class="figure-image figure-image-fotolife" title="10進数を受理するオートマトンを表す状態遷移図">[f:id:ydah:20250427033633p:plain]<figcaption>10進数を受理するオートマトンを表す状態遷移図</figcaption></figure>

この図を見てみると非常にわかりやすいことがわかると思います。
まず、入力として"0"が入力された場合、状態 q0 から状態 q1 に遷移します。q1 に遷移した後は、状態 q1 は受理状態なので、受理状態に達したことになります。
ただし、状態 q1 にはそれ以上の状態遷移が存在しないので、最初に "0"が入力された場合は、それ以上の入力のある記号列を受理しないことがわかります。

続いて、最初に"1"が入力された場合、状態 q0 から状態 q2 に遷移します。q2 に遷移した後は、状態 q2 は受理状態なので、受理状態に達したことになります。
それ以降は、どのような入力がきても、状態は q2 から変化しないので、この有限オートマトンは、最初が"1"から"9"までの数字で始まるどのような記号列も受理することがわかります。

#### 状態遷移表

続いて、状態遷移表を示します。

<figure class="figure-image figure-image-fotolife" title="10進数を受理する有限オートマトンを表す状態遷移表">[f:id:ydah:20250427033714p:plain]<figcaption>10進数を受理する有限オートマトンを表す状態遷移表</figcaption></figure>

この表は、状態遷移関数の入力と状態の組に対して次の状態を表しています。
縦軸と横軸がそれぞれ状態と入力を示しています。

また、状態pと入力aに対して、δ(p, a) = q という状態遷移が存在するとき、状態pを表す縦軸と入力aを表す横軸の交点に、状態遷移先の次の状態を示す状態qを記載します。


ここまで説明した、状態遷移図や状態遷移表を用いることで、最初に説明した形式的な有限オートマトンを表現できます。

## 有限オートマトンの作り方

では、最後に有限オートマトンを作成する方法について見ていきましょう。
作成方法は大まかにですが、以下のような手順で有限オートマトンを作成できます。

* 条件を満たす有限オートマトンに必要な状態を考える
* 各状態に対して、すべての入力に対する状態遷移を考える

テキストエディターには、入力記号列の中から指定された記号列を検索する機能が必ず存在します。そこで、入力記号の集合を Σ = {y, d, a, h}として、記号列 "ydah" が出現すると受理状態になる有限オートマトンを作成してみましょう。

例: 入力記号列を dhydhahyyhydahdah とした場合に、14文字目のhが入力された後の状態は受理状態となります。その他の場合には受理状態とはなりません。
これは言い換えると、この有限オートマトンが受理する記号列は "ydah" で終わる記号列であり、言語 L としてこの有限オートマトンが認識する言語は以下のようになります。

```
L = { xydah | Σ = {y, d, a, h}, x ∈ Σ* }
```

このような有限オートマトンを作成するために、まず、条件を満たす有限オートマトンに必要な状態から考えていきます。
初期状態は何も入力されていない状態なので、受理状態ではない、次に "ydah" という記号列を認識するためには、最初の "y" が入力された状態、最初の 'y" に続いて2番目の "d" が入力された状態、3番目の "a" が入力された状態、4番目の "h" が入力された状態の5つの状態が必要です。そして、最後の状態が受理状態となります。

これらをまとめると、状態遷移図で表すと以下のようになります。

<figure class="figure-image figure-image-fotolife" title="有限オートマトンに必要な4つの状態">[f:id:ydah:20250427034032p:plain]<figcaption>有限オートマトンに必要な4つの状態</figcaption></figure>

* q1: 最初の"y"が入力された場合
* q2: 最初の"y"に続いて2番目の"d"が入力された場合
* q3: 2番目の"d"に続いて、3番目の"a"が入力された場合
* q4: 3番目の"a"に続いて、4番目の"h"が入力された場合


次に各状態に対して、すべての入力に対する状態遷移を考えていきます。まず、状態 q0 に関する状態遷移を考えると、入力が "y" と "d", "a", "h" の場合に対して、以下のような状態遷移が考えられるので、次の状態遷移が得られます。

<figure class="figure-image figure-image-fotolife" title="有限オートマトンの初期状態に対する状態遷移">[f:id:ydah:20250427034100p:plain]<figcaption>有限オートマトンの初期状態に対する状態遷移</figcaption></figure>

* 入力が "y" の場合: 文字列 "ydah" の最初の "y" が入力されたことになるので、状態 q1 に遷移します
* 入力が "d" の場合: 文字列 "ydah" の最初の "y" が入力されていないので、状態 q0 のまま状態 q0 に留まります
* 入力が "a" の場合: 文字列 "ydah" の最初の "y" が入力されていないので、状態 q0 のまま状態 q0 に留まります
* 入力が "h" の場合: 文字列 "ydah" の最初の "y" が入力されていないので、状態 q0 のまま状態 q0 に留まります

最後に、残りの状態に関しても同様に考えていきます。すると、以下のような状態遷移が得られます。

<figure class="figure-image figure-image-fotolife" title="有限オートマトンを表す状態遷移図">[f:id:ydah:20250427175226p:plain]<figcaption>有限オートマトンを表す状態遷移図</figcaption></figure>

このように整理していけば、有限オートマトンを作成できます。
さて、これで有限オートマトンについての定義と、有限オートマトンの作り方について説明しました。


## まとめと次回予告

今回の内容の要点は以下の通りです。

* 有限オートマトンは状態数が有限な認識機械であり、入力列に対して「受理」または「拒否」を出力する
* 言語とは記号を連続して並べたものの集合で、特定の条件を満たす記号列の集合として定義される
* オートマトンと形式文法は言語を定めるための道具である
* オートマトンは「変換機械」と「認識機械」の2つに分類でき、有限オートマトンは認識機械の一種である
* 有限オートマトンの動作は状態遷移図や状態遷移表を用いて視覚的に表現できる
* 有限オートマトンを作成するには、まず必要な状態を考え、次に各状態に対するすべての入力に対する状態遷移を定義する

次回は、 **様々な有限オートマトンや有限オートマトンの限界** について学びます。

オートマトンと言語理論について学習している方や、これから学習しようと考えている方はぜひ一緒に学んでいきましょう。
この学習記は、オートマトンと言語理論の基礎を学ぶためのものですので、内容に誤りや不明点があればぜひコメントで教えてください。
